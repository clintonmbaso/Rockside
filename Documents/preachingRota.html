<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preaching Rota</title>
    <link rel="stylesheet" href="letterHead.css">
    <!-- Font Awesome CDN for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
textarea {
  width: 100%;
  border: none;
  padding: 5px 2px 2px 2px;/*
  font-size: 14px;*/
  font-family: "Times New Roman", Times, serif;
  resize: none;
  overflow: hidden;/*
  height: 20px;*/
  margin-bottom: -7px;
  box-sizing: border-box;
  word-wrap: break-word;
}

textarea:focus {
  outline: none;
  background: #f0fff0;
}
  
.rotated-month {
  writing-mode: vertical-rl;
  transform: rotate(-180deg);
  text-align: center;
  vertical-align: middle;
  padding: 5px;
  margin: 3px 0;
  border-radius: 0 15px 15px 0;
  min-width: 30px;
  font-weight: bold;
  background: rgba(23,45,92,0.2);
}
  
.dateCell {
  
}
  </style>
</head>
<body>

    <!-- Main Content Area -->
    <div class="content">



        <header>
            <h1 class="sdaName">ROCKSIDE SDA CHURCH</h1>
            <p>C/O MULUNGUSHI UNIVERSITY,<br>P.O BOX 80415.<br>KABWE.</p>
            <p>Phone: <a href="tel:+260766613234">+260766613234</a> | <a href="tel:+260976134445">+260976134445</a> | Email: <a href="mailto:rocksidesda@gmail.com">rocksidesda@gmail.com</a><!-- | Website: <a href="#">www.rocksidesdachurch.com</a>--></p>
        </header>

        <hr>

        <div id="date">Date: </div>
<script>
    // Function to get and format the current date
    function getFullDate() {
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const currentDate = new Date().toLocaleDateString('en-US', options);
        return currentDate;
    }

    // Insert the date into an element with the id 'date'
    document.getElementById('date').textContent = getFullDate();
</script>
        
            <h3 class="department"><strong>PERSONAL MINISTRIES DEPARTMENT</strong></h3>

        
        <div class="recipient">
            <h3 style="text-align: center;"><strong>PREACHING ROTA</strong></h3>
        </div>

		<div class="theme">    
		    <h4 class="titled">2nd Quarter</h4>
		    

<table id="rotaTable" class="modern-table">
  <thead>
  <tr>
    <th></th>
    <th>Date</th>
    <th>Preacher</th>
    <th>Interpreter</th>
    <th>First Prayer</th>
    <th>Pulpit Manager</th>
    <th>Bible Study</th>
  </tr>
</thead>
  <tbody class="inputField">
    <!-- Rows will be generated by JS -->
  </tbody>
</table>
		  
		</div>
    
        <p><em>In Christ Service.</em></p>

    
        <div class="signature" id="why" style="display: flex; justify-content: space-between;">
            <p><b>Elder in Charge</b><br><em>Elder. Daniel Shimau</em><br><a href="tel:+260979915503">+260979915503</a><br><br>_________________<!--<img src="signatures/gmorrisBwalyaSignature.png" alt="clerk" class="clerk">--></p>
            
            <p style="text-align:right;"><b>Personal Ministries Leader</b><br><em>Elder. Henery Bautu Jawa</em><br><a href="tel:+260977445830">+260977445830</a><br><br>_________________<!--<img src="signatures/jawaBautuSignature.png" alt="pm" class="pm">--></p>
            
        </div>

        <div class="footer">
        "All things should be done decently and in order." â€” 1 Corinthians 14:40
        </div>

<!-- Button Container -->
<div class="btn-container">
    <button class="btn print-btn" onclick="window.print()">
        <i class="fas fa-print"></i> Print
    </button>
    <br>

</div>

    </div>
        <!-- Right Sidebar for Logo -->
    <div class="sidebar">
        <img class="One1" src="./icons/sdaLogos.png" alt="Church Logo">
        <p><b>Seventh-Day</b> <span class="adventist"><b>Adventist</b></span> <b>Church</b></p>
    </div>

<script>
  // === SETTINGS ===
  const startDate = new Date("2025-04-01"); // Set your starting Sabbath here
  const endDate = new Date(startDate);
  endDate.setMonth(startDate.getMonth() + 3);

  const roles = ["Preacher", "Interpreter", "First Prayer", "Pulpit Manager", "Bible Study"];
  const tableBody = document.querySelector("#rotaTable tbody");

  // Generate all Sabbaths within the 3-month range
  let current = new Date(startDate);
  const sabbathDates = [];

  while (current < endDate) {
    if (current.getDay() === 6) { // Saturday
      sabbathDates.push(new Date(current));
    }
    current.setDate(current.getDate() + 1);
  }

  // Group Sabbaths by month
  const sabbathsByMonth = {};
  sabbathDates.forEach(date => {
    const monthKey = `${date.getFullYear()}-${date.getMonth()}`;
    if (!sabbathsByMonth[monthKey]) sabbathsByMonth[monthKey] = [];
    sabbathsByMonth[monthKey].push(date);
  });

  const savedData = JSON.parse(localStorage.getItem("preachingRota") || "{}");

  // Generate rows with month rowspan
  Object.keys(sabbathsByMonth).forEach(monthKey => {
    const dates = sabbathsByMonth[monthKey];
    const monthName = dates[0].toLocaleString("default", { month: "long", year: "numeric" });

    dates.forEach((dateObj, index) => {
      const row = document.createElement("tr");
      const dateStr = dateObj.toISOString().split("T")[0];

      // Add month cell only once
      if (index === 0) {
        const monthCell = document.createElement("td");
        monthCell.classList.add("rotated-month");
        monthCell.textContent = monthName;
        monthCell.rowSpan = dates.length;
        row.appendChild(monthCell);
      }

      // Date
      const dateCell = document.createElement("td");
      dateCell.classList.add("dateCell");
      dateCell.textContent = dateObj.toDateString();
      row.appendChild(dateCell);

      // Roles
      roles.forEach(role => {
        const cell = document.createElement("td");
        const input = document.createElement("textarea");
        const key = `${dateStr}_${role}`;
        input.value = savedData[key] || "";

        input.addEventListener("input", () => {
          savedData[key] = input.value;
          localStorage.setItem("preachingRota", JSON.stringify(savedData));
          input.style.height = "auto";
          input.style.height = input.scrollHeight + "px";
        });

        setTimeout(() => {
          input.style.height = "auto";
          input.style.height = input.scrollHeight + "px";
        }, 0);

        cell.appendChild(input);
        row.appendChild(cell);
      });

      tableBody.appendChild(row);
    });
  });
</script>

</body>
</html>